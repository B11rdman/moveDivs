<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Draggable DIV</title>
    <script src="https://kit.fontawesome.com/edb048d6f4.js" crossorigin="anonymous"></script>
    <style>
        body{
            background-color: #000000;
            color: #fff;
            background-image: url(bg.jpg);
            background-size: cover;
            padding: 0;
            margin: 0;
        }

        #minimizedOnes {
            position: fixed;
            padding: 0;
            background-color: #2158d6;
            bottom: 0;
            height: 40px;
            display: flex;
        }

        #start {
            background-image: url(menu.jpg);
            background-repeat: no-repeat;
            height: 40px;
            width: 55px;
            background-size: 100%;
        }

        #minimizeAll {
            width: 20px;
            background-color: rgba(255, 255, 255, 0.61);
            position: absolute;
            right: 0;
            height: 40px;
        }

        .topButton {
            background-color: #4CAF50; 
            border: none;
            color: white;
            padding: 10px 25px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            transition: 0.4s;
        }

        .topButton:hover {
            background-color: #fff; 
            color: #4CAF50; 
        }

        .minimized {
            background-color: #3980f4;
            transition: 0.4s;
            width: 50px;
            height: 40px;
            border: 1px solid blue;
            border-radius: 5px;

        }

        .minimized:hover {
            background-color: #fff;
            color: #3980f4;
        }


    </style>
</head>
<body>
    
    <button class='topButton' onclick="createNewDiv('p')">Text</button>
    <button class='topButton' onclick="createNewDiv('video')">Video</button>
    <button class='topButton' onclick="createNewDiv('image')">Image</button>
    <button class='topButton' onclick="createNewDiv('website')">Website</button>

    <div id="minimizedOnes">
        <div id="start" onclick="display()"></div>
        <div id="minimizeAll" onclick="minimizeAll()"></div>
    </div>

    <script>
        let i = 0,
            z = 1,
            pressed = false,
            shiftX = 0,
            shiftY = 0,
            elm = null,
            elmToHide = null,
            iframe = null,
            openPositions = [];

            document.body.style.height = innerHeight + 'px';
            document.getElementById('minimizedOnes').style.width = innerWidth + 'px';

        function createNewDiv(inside){
            let divHead = 'divHead' + i,
            buttonClose = 'button' + i,
            buttonMin = 'min' + i;
            div = 'div' + i,
            openPosition = {},
            openPosition.index = i;
        
            openPositions.push(openPosition);

            divHead = document.createElement('div');
            divHead.id = `innerDiv${i}`;
            divHead.className = 'innerDiv';

            buttonClose = document.createElement('button');
            buttonClose.id = `button${i}`;
            buttonClose.className = 'button';

            buttonMin = document.createElement('button');
            buttonMin.id = `buttonMin${i}`;
            buttonMin.className = 'buttonMin';

            div = document.createElement('div');
            div.id = `div${i}`;
            div.className = 'removableDiv';

            divHead.appendChild(buttonClose);
            divHead.appendChild(buttonMin);

            div.appendChild(divHead);
           
            switch(inside){
                case 'p':
                    let p = 'p' + i;
                    p = document.createElement('p');
                    p.id = `p${i}`;
                    p.className = 'text'
                    div.appendChild(p);
                    break;
                case 'image':
                    let img = 'img' + i;
                    img = document.createElement('img');
                    img.src = 'https://images.discordapp.net/avatars/667397272107089982/3dfe6ead6f9b556b79aabf73ebb0db52.png?size=512';
                    img.width = '200';
                    img.height = '200';
                    img.className = 'img';
                    div.appendChild(img);
                    break;
                case 'video':
                    iframe = 'iframe' + i;
                    iframe = document.createElement('iframe');
                    iframe.name = 'iframe' + i;
                    iframe.width = '200';
                    iframe.height = '113';
                    iframe.src = 'https://www.youtube.com/embed/TfRhPkkL6v0';
                    iframe.allow = 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture';
                    div.appendChild(iframe);
                    break;
                case 'website':
                    iframe = 'iframe' + i;
                    iframe = document.createElement('iframe');
                    iframe.name = 'iframe' + i;
                    iframe.width = '450';    
                    iframe.height = '250';
                    iframe.src = 'https://www.list.am/';
                    div.appendChild(iframe);
                    break;
            }

            document.body.appendChild(div);

            document.getElementById(`innerDiv${i}`).style.backgroundColor = '#6878d8';
            document.getElementById(`innerDiv${i}`).style.padding = 10 + 'px';
            document.getElementById(`innerDiv${i}`).style.display = 'flex';
            document.getElementById(`innerDiv${i}`).style.position = 'relative';
            document.getElementById(`innerDiv${i}`).style.userSelect = 'none';

            document.getElementById(`button${i}`).style.position = 'absolute';
            document.getElementById(`button${i}`).style.right= 10 +'px';
            document.getElementById(`buttonMin${i}`).style.position = 'absolute';
            document.getElementById(`buttonMin${i}`).style.right= 30 +'px';

            document.getElementById(`button${i}`).innerHTML = '&times';
            document.getElementById(`button${i}`).style.userSelect = 'none';

            document.getElementById(`buttonMin${i}`).innerHTML = '&lowbar;';
            document.getElementById(`buttonMin${i}`).style.userSelect = 'none';

            document.getElementById(`div${i}`).style.position = 'absolute';

            document.getElementById(`div${i}`).setAttribute('index', i);

            document.getElementById(`div${i}`).style.top = openPositions[i].y + 'px';
            document.getElementById(`div${i}`).style.left = openPositions[i].x + 'px';


            document.getElementById(`div${i}`).style.backgroundColor = '#4288e6';
            document.getElementById(`div${i}`).style.borderRadius = 10 + 'px';
            document.getElementById(`div${i}`).style.width = 200 + 'px';

            switch(inside) {
                case 'p':
                    document.getElementById(`p${i}`).innerHTML = `I am movable div #${i}`;
                    document.getElementById(`p${i}`).style.userSelect = 'none';
                    document.getElementById(`div${i}`).setAttribute('content', inside);
                    openPosition.x = Math.floor(Math.random()*(innerWidth - 200));
                    openPosition.y = Math.floor(Math.random()*(innerHeight - 200)) + 50; 
                    document.getElementById(`div${i}`).style.top = openPositions[i].y + 'px';
                    document.getElementById(`div${i}`).style.left = openPositions[i].x + 'px';
                    break;
                case 'website':
                    document.getElementById(`div${i}`).style.width = 450 + 'px';
                    document.getElementById(`div${i}`).setAttribute('content', inside);
                    openPosition.x = Math.floor(Math.random()*(innerWidth - 470));
                    openPosition.y = Math.floor(Math.random()*(innerHeight - 380)) + 50; 
                    document.getElementById(`div${i}`).style.top = openPositions[i].y + 'px';
                    document.getElementById(`div${i}`).style.left = openPositions[i].x + 'px';
                    break;
                case 'image':
                    openPosition.x = Math.floor(Math.random()*(innerWidth - 200));
                    openPosition.y = Math.floor(Math.random()*(innerHeight - 330)) + 50; 
                    document.getElementById(`div${i}`).style.top = openPositions[i].y + 'px';
                    document.getElementById(`div${i}`).style.left = openPositions[i].x + 'px';
                    document.getElementById(`div${i}`).setAttribute('content', inside);
                    break;
                case 'video':
                    openPosition.x = Math.floor(Math.random()*(innerWidth - 200));
                    openPosition.y = Math.floor(Math.random()*(innerHeight - 230)) + 50; 
                    document.getElementById(`div${i}`).style.top = openPositions[i].y + 'px';
                    document.getElementById(`div${i}`).style.left = openPositions[i].x + 'px';
                    document.getElementById(`div${i}`).setAttribute('content', inside);
                    break;
            }

            openPositions[i].item = document.getElementById(`div${i}`);
            i++;
        }

        function down(e){
            shiftX = event.clientX - e.getBoundingClientRect().left;
            shiftY = event.clientY - e.getBoundingClientRect().top;
            pressed = true;
            z++;
            e.style.zIndex = z;
        }

        function move(e, x, y){
                e.style.top = y - shiftY + 'px';
                e.style.left = x - shiftX + 'px';
        }

        document.addEventListener('mousedown', function(){
            if(event.button === 0){
                switch(event.target.className){
                    case 'button':
                        elm = event.target.parentNode.parentNode; 
                        event.target.parentNode.parentNode.remove();
                        break;
                    case 'removableDiv':
                        z++;
                        event.target.style.zIndex = z;
                        break;
                    case 'text':
                        z++;
                        event.target.parentNode.style.zIndex = z;
                        break;
                    case 'innerDiv':
                        elm = event.target.parentNode; 
                        down(elm);
                        break;
                    case 'buttonMin':
                        elmToHide = event.target.parentNode.parentNode;                                                 
                        addMinimize(event.target.parentNode.parentNode.getAttribute('index'), event.target.parentNode.parentNode.getAttribute('content'));
                        minimizedIcon(event.target.parentNode.parentNode.getAttribute('index'));
                        break;
                    case 'minimized':
                        maximize(event.target.getAttribute('index'));
                        break;
                }
            }
        });

        function minimizedIcon(index) {
            for(let i = 0; i < openPositions.length; i++){
                if(openPositions[i].item.getAttribute('index') === index){
                    openPositions[i].minimizedElm.style.display = 'block';
                    openPositions[i].item.style.display = 'none';
                }
            }
        };

        function addMinimize(index, icon){
            for (let i = 0; i < openPositions.length; i++){
                if(i === parseInt(index) && openPositions[i].minimizedElm){
                    minimizedIcon(index)
                } else if(i === parseInt(index) && !openPositions[i].minimizedElm){
            
                    let divMin = 'div' + index;
                    divMin = document.createElement('div');
                    divMin.id = `minimized${index}`; 
                    divMin.className = `minimized`; 
                    document.getElementById('minimizedOnes').appendChild(divMin);
                    document.getElementById(`minimized${index}`).style.display = 'none';
                    document.getElementById(`minimized${index}`).setAttribute('index', index);
                    document.getElementById(`minimized${index}`).style.userSelect = 'none';
                    
                    switch(icon){
                        case 'p':
                            document.getElementById(`minimized${index}`).innerHTML = '<i class="fas fa-file-alt"></i>' + index;
                            break;
                        case 'image':
                            document.getElementById(`minimized${index}`).innerHTML = '<i class="fas fa-image"></i>' + index;
                            break;
                        case 'video':
                            document.getElementById(`minimized${index}`).innerHTML = '<i class="fas fa-video"></i>' + index;
                            break;
                        case 'website':
                            document.getElementById(`minimized${index}`).innerHTML = '<i class="fas fa-pager"></i>' + index;
                            break;
                        }
                        openPositions[index].minimizedElm = document.getElementById(`minimized${index}`);
                }
            }   
        }

        function minimizeAll(){
            for (let i = 0; i < openPositions.length; i++){
                if(openPositions[i].minimizedElm){
                    for(let i = 0; i < openPositions.length; i++){
                        openPositions[i].minimizedElm.style.display = 'block';
                        openPositions[i].item.style.display = 'none';
                    }
                } else if(!openPositions[i].minimizedElm){
                    let divMin = 'div' + i;
                    divMin = document.createElement('div');
                    divMin.id = `minimized${i}`; 
                    divMin.className = `minimized`; 
                    document.getElementById('minimizedOnes').appendChild(divMin);
                    document.getElementById(`minimized${i}`).style.display = 'block';
                    document.getElementById(`minimized${i}`).setAttribute('index', i);
                    document.getElementById(`minimized${i}`).style.userSelect = 'none';
                    
                    switch(openPositions[i].item.getAttribute('content')){
                        case 'p':
                            document.getElementById(`minimized${i}`).innerHTML = '<i class="fas fa-file-alt"></i>' + i;
                            break;
                        case 'image':
                            document.getElementById(`minimized${i}`).innerHTML = '<i class="fas fa-image"></i>' + i;
                            break;
                        case 'video':
                            document.getElementById(`minimized${i}`).innerHTML = '<i class="fas fa-video"></i>' + i;
                            break;
                        case 'website':
                            document.getElementById(`minimized${i}`).innerHTML = '<i class="fas fa-pager"></i>' + i;
                            break;
                        }
                        openPositions[i].minimizedElm = document.getElementById(`minimized${i}`);
                        openPositions[i].item.style.display = 'none';
                }
            }   
        }

        function maximize(index) {
            for(let i = 0; i < openPositions.length; i++){
                if(openPositions[i].item.getAttribute('index') === index){
                    openPositions[i].minimizedElm.style.display = 'none';
                    openPositions[i].item.style.display = 'block';
                    z++;
                    openPositions[i].item.style.zIndex = z;
                }
            }
        }

        document.addEventListener('mousemove', function(){
            if (pressed){
                move(elm, event.clientX, event.clientY)
            }
        })

        document.addEventListener('mouseup', function(){
            pressed = false;
        })

        function display(){
            for(let i = 0; i < openPositions.length; i++) {
                openPositions[i].item.style.display = 'block';
                if (openPositions[i].minimizedElm){
                openPositions[i].minimizedElm.style.display = 'none';
            }
        }
        }
    </script>
</body>
</html>